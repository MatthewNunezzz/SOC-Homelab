# Vulnerability Assessment Report: Domain Controller

**Target:** 172.16.0.2 (Windows Server 2022)

**Date:** 12/26/2025

**Assessor:** Matthew Nunez

**Risk:** Medium

---

## 1. Report Summary

A basic network scan was performed on the Primary Domain Controller (Windows Server 2022). The most significant findings relate to missing cumulative update patches, which could allow a multitude of attacks from an attacker already within the private network; including remote code execution, denial of service, privilege escalation, and more. While the severity of these vulnerabilities is critical, the current Risk is rated as **Medium** due to the host's placement within a segmented private lab environment, which limits external exposure.

![](nessus_screenshots/nessus_ss_00.png)

---

## 2. Scope & Methodology

* **Scan Tool:** Nessus Essentials 10.11.1
* **Scan Type:** Basic Network Scan (Credentialed)
* **Target Host:** `WIN-MEUJ3KPDEG5` (172.16.0.2)
* **Network Segment:** Lab Internal (172.16.0.0/24)

---

## 3. Vulnerability Breakdown

### Microsoft Edge (Missing "Cumulative Update" Patches)

* **Severity:** Critical
* **family:** Windows
* **Total Vulnerability Count:** 195
* **Description:** The version of Microsoft Edge installed is severely outdated and is exposed to numerous vulnerabilities including Use-after-free, heap buffer overflow, etc.
* **Evidence:** ![](nessus_screenshots/nessus_ss_01.png)
* **Remediation Steps:**
    1. Update Microsoft Edge to version 142.0.3595.90 or later via Windows Update or the official Microsoft Edge installer
    2. Enable automatic browser updates
    3. Restart Microsoft Edge
    4. Re-scan host using Nessus to confirm vulnerability is resolved.

### Missing Security Updates for Windows Server 2022

* **Severity:** Critical
* **family:** Windows: Microsoft Bulletin
* **Total Vulnerability Count:** 44
* **Description:** The Windows Server is many security updates behind exposing it to a multitude of vulnerabilities including heap buffer overflow, remote code execution, elevation of privilege, etc.
* **Evidence:** ![](nessus_screenshots/nessus_ss_02.png)
* **Remediation Steps:**
    1. Install most recent cumulative update for Windows Server 2022 (KB5068787 or later) using Windows Update.
    2. Schedule and Perform a Controlled System Reboot
    3. Confirm installed update via: `winver` or Windows Update History
    4. Re-scan host using Nessus to confirm vulnerability is resolved

### Missing Security Updates for Microsoft .NET Framework

* **Severity:** Critical
* **family:** Windows
* **Total Vulnerability Count:** 33
* **Description:** The Microsoft .NET Framework installation on the domain controller is missing security updates exposing it to multiple vulnerabilities including Denial of service, man-in-the-middle, remote code execution, etc.
* **Evidence:** ![](nessus_screenshots/nessus_ss_03.png)
* **Remediation Steps:** 
    1. Run Windows Update and Install:
        - Latest Cumulative Update
        - Latest .NET Framework Security & Quality Rollup
    2. Verify installed .NET version is 4.8.4690.0 or later
    3. Perform System Reboot
    4. Re-scan host using Nessus to confirm vulnerability is resolved

### SSL Medium Strength Cipher Suites (SWEET32) on RDP

* **Severity:** High
* **family:** General
* **Nessus Plugin ID:** 42873
* **CVE:** CVE-2016-2183, CVE-2016-6329
* **MITRE ATT&CK:** Adversary-in-the-Middle (T1557)
* **Port / Protocol:** 3389 / tcp / msrdp
* **Description:** Domain controller supports the use of SSL ciphers that offer medium strength encryption (less than 112 bit key length). This vulnerability allows for collision attacks. While commonly associated with HTTPS, its presence on RDP (Port 3389) could allow an attacker to monitor administrative sessions and potentially recover sensitive credentials. 
* **Evidence:** ![](nessus_screenshots/nessus_ss_04.png)
* **Remediation Steps:**
    1. Disable the following cipher suites via Group Policy or Registry:
        - `TLS_RSA_WITH_3DES_EDE_CBC_SHA`
        - Any cipher using `3DES` or `CBC` with 64-bit blocks
    2. Prefer AES-GCM and AES-CBC (128/256) cipher suites
    3. Enforce strong TLS versions only:
        - Disable: 
            - SSL 2.0
            - SSL 3.0
            - TLS 1.0
            - TLS 1.1
        - Enable only:
            - TLS 1.2 (mandatory)
            - TLS 1.3 if supported and tested
    4. Set RDP to use SSL (TLS 1.2) and Enable Network Level Authentication (NLA)
    5. Reboot the system and verify TLS and cipher settings post-reboot
    6. Re-scan host using Nessus to confirm vulnerability is resolved

### WinVerifyTrust Signature Validation CVE-2013-3900 Mitigation (EnableCertPaddingCheck)

* **Severity:** High
* **family:** Windows: Microsoft Bulletin
* **Nessus Plugin ID:** 166555
* **CVE:** CVE-2013-3900
* **MITRE ATT&CK:** Subvert Trust Controls: Code Signing (T1553.002)
* **Port / Protocol:** 445 / tcp / cifs
* **Description:** A remote code execution vulnerability exists in the way the WinVerifyTrust function handles signature verification for portable execution files. This vulnerability allows an attacker to append malicious code to the padding of a signed file.
* **Evidence:** ![](nessus_screenshots/nessus_ss_05.png)
* **Remediation Steps:**
    1. Enable certificate padding checks in Windows Registry
        - Create or update the following registry value:
            ```java
            HKLM\Software\Microsoft\Cryptography\Wintrust\Config
            EnableCertPaddingCheck = 1 (DWORD)
            ```
        - For 64-bit systems, also set:
            ```java
            HKLM\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config
            EnableCertPaddingCheck = 1 (DWORD)
            ```
    2. Apply setting via Group Policy (Recommended)
    3. Ensure lastest Windows security updates are installed. Without supporting fixes, the registry key can be ignored or inconsistently enforced.
    4. Re-scan host using Nessus to confirm vulnerability is resolved

### Security Updates for Windows Defender

* **Severity:** High
* **family:** Windows: Microsoft Bulletin
* **Total Vulnerability Count:** 20
* **Description:** The Malware Protection Engine of Microsoft Windows Defender installed is a few security updates behind exposing the system to a multitude of vulnerabilities including denial of service, privilege escalation, etc.
* **Evidence:** ![](nessus_screenshots/nessus_ss_06.png)
* **Remediation Steps:**
    1.  Update Windows Defender to platform version 4.18.24010.12 or later using Windows Update
        - Update:
            - Platform
            - Engine
            - Security intelligence definitions
    2. Enable automatic defender updates:
        - Ensure automatic updates enabled for:
            - Defender platform
            - Security intelligence
    3. Verify Defender is actively running:
        - Check Status:
            ```powershell
            Get-MpComputerStatus
            ```
    4. Restart Microsoft Defender Antivirus Service
    5. Re-scan host using Nessus to confirm vulnerability is resolved

### Curl Use-After-Free < 7.87

* **Severity:** Medium
* **family:** Windows
* **Nessus Plugin ID:** 171859 
* **CVE:** CVE-2022-43552
* **MITRE ATT&CK:** Exploitation for Client Execution (T1203)
* **Port / Protocol:** 445 / tcp / cifs
* **Description:** Version of Curl installed is 7.79.1.0 making it susceptible to the use-after-free vulnerability. Such a vulnerability can allow an attacker to trick curl into executing malicious code.
* **Evidence:** ![](nessus_screenshots/nessus_ss_08.png)
* **Remediation Steps:**
    1. Locate installed curl binaries
    2. Check version: `curl --version`
    3. Update curl through Windows Update or Windows Package Managers (Winget/Chocolatey)
    4. Re-scan host using Nessus to confirm vulnerability is resolved

---

## 4. Port & Service Summary

| Port | Service | Status | Justification / Business Need |
| --- | --- | --- | --- |
| **53** | DNS | Open | Essential for Active Directory domain controller discovery and name resolution. |
| **67/68** | DHCP | Open | Manages automatic IP address assignment for clients on the network. |
| **88** | Kerberos | Open | Primary authentication protocol for Active Directory users and services. |
| **135** | RPC Endpoint Mapper | Open | Required for AD Replication, Group Policy processing, and Remote Management. |
| **137-139** | NetBIOS Services | Open | Supports legacy name resolution and older file-sharing protocols. |
| **389 / 636** | LDAP / LDAPS | Open | Used for directory service queries; 636 provides secure, encrypted communication. |
| **445** | SMB over IP | Open | Facilitates file sharing and the distribution of Group Policy Objects (GPOs). |
| **464** | Kerberos Password | Open | Allows users to change or reset passwords across the domain. |
| **593** | RPC over HTTP | Open | Enables RPC Endpoint Mapping over HTTP/HTTPS for improved firewall traversal. |
| **2535** | MADCAP | Open | Assigns multicast IP addresses (typically part of DHCP Server role). |
| **3268 / 3269** | Global Catalog | Open | Forest-wide searches and Universal Group membership verification. |
| **3389** | RDP | Open | Facilitates remote administrative access to the server. |
| **5353** | mDNS | Open | Multicast DNS; used for local device discovery |
| **5355** | LLMNR | Open | Link-Local Multicast Name Resolution; legacy name resolution for local subnets. |
| **5985** | WinRM (HTTP) | Open | Windows Remote Management; used for PowerShell remoting and automation. |
| **9389** | AD Web Services | Open | Provides a management interface for AD PowerShell and Administrative Center. |
| **47001** | WinRM Management | Open | Used by the WinRM service for listening to management requests. |
| **49664 - 49700** | RPC Dynamic Ports | Open | High-range ports used dynamically by AD for replication and client requests. |

### Network Hardening Recommendations:
| Port | Service | Action | Why disable it? |
| --- | --- | --- | --- |
| 137-139 | NetBIOS | Disable | Obsolete. Modern Windows uses Port 445 for everything NetBIOS used to do. |
| 5355 | LLMNR | Disable | Highly vulnerable port due to vulnerabilities like "LLMNR poisoning". |
| 5353 | mDNS | Disable | Only needed for device discovery. Not needed for a Domain Controller. |
| 389 | LDAP | Switch to 636 (LDAPS) | Force secure version of LDAP and close 389 | 
| 3268 | Global Catalog | Switch to 3269 (GC SSL) | Force GC over SSL and close 3268 |
| 5985 | WinRM (HTTP) | Switch to 55986 (HTTPS) | Disable 5985 to ensure remote PowerShell is encrypted |
| 2535 | MADCAP | Disable | Only needed for multicast video streaming || 

### Remediation Steps

1. Disable NetBIOS over TCP/IP (Ports 137-139):
    - Disable NetBIOS on all network interfaces
        - Via DHCP options or NIC IPv4 advanced settings
    - Confirm SMB functionality continues over port 445
    - Verify no legacy applications depend on NetBIOS name resolution

2. Disable LLMNR:
    - Disable LLMNR via Group Policy:
        - Computer Config. > Administrative Temp. > Network > DNS Client > Turn off multicast name resolution = Enabled

3. Disable mDNS:
    - Disable the mDNS service where present
    - Block UDP 5353 via host-based firewall if service cannot be disabled
    - Confirm no device discovery or zero-config services are required

4. Enforce LDAPS and disable LDAP:
    - Deploy a valid certificate to all domain controllers
    - Enable LDAPS (port 636)
    - Configure clients and applications to use LDAPS
    - Block or disable inbound LDAP on port 389 after validation

5. Enforce Global Catalog over SSL and disable 3268:
    - Verify GC SSL (3269) is functional
    - Update applications to query GC over SSL
    - Block or disable port 3268 after confirmation

6. Secure WinRM by enforcing HTTP
    - Configure WinRM listeners for HTTPS (port 5986)
    - Deploy certificates for WinRM
    - Disable WinRM HTTP listener on port 5985
    - Test remote PowerShell functionality

7. Disable MADCAP (Port 2535)
    - Disable MADCAP service if present
    - Block UDP 2535 via host-based firewall
    - Confirm multicast services are not required

8. Implement host-based firewall rules
    - Use Windows Defender Firewall to:
    - Explicitly allow required AD ports
    - Block all unnecessary legacy services
    - Apply rules via Group Policy for consistency

9. Validate functionality and security posture
    - Test:
        - Domain authentication
        - LDAP queries
        - Administrative access
    - Re-run vulnerability scans
    - Confirm closed ports are no longer listening

---

## Conclusion

The vulnerability assessment of the Domain Controller identified a significant attack surface, primarily due to outdated patch levels and legacy configurations. Following the identification of vulnerabilities, actionable security recommendations involving installation of security patches and security configurations has been put forth.